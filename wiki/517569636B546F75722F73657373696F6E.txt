#freeze
#contents

*セッションファイルは便利 [#bc3dc3f0]

**便利に使えてきそう…… [#a9b93878]

今日紹介する機能は、Windows上のエディタの中ではあまり見かけない機能である''セッションファイル''についてです。今までは基本的な内容が多くてあんまり役に立たなかったかもしれないけど、このセッションファイルは便利ですよ。何と言っても簡単に使えて、かつ非常に便利なのです。おすすめです。

その前に前回と同様、本題に入る前にキーバインドの紹介を少ししたいと思います。少し前に、カーソル移動系のキーバインドの話をしましたけど、その続きです。''C-vを押すと、行カーソルが画面一つ分だけ下に移動''します。''逆は、M-v''です。他にもM-fとか押してみると、少し違ったカーソル移動ができると思います。

**それじゃ、セッションファイルの事 [#ef2cf88a]

では、本題に入ります。''「セッションファイル」ってのは、複数のファイルを一気に開くことのできるファイル''です。んー、相変わらず説明が良くわかんない。というわけで、実際にやってみてもらった方が早いかも。

というわけで、そのセッションファイルというのを作ってみましょう。
まず、幾つかファイルを開いてみてください。ファイル一つだとあんまり面白くないので、三つ四つくらい開いてみてください。

#br
#br

CENTER:''とりあえず下のように開いてみた''
CENTER:#ref(01.png,center,100%)
CENTER:#img(,clear)
CENTER:&size(10){三つほど開いてみた。カーソル位置とかを適当に変更しておくと良いかも。};

#br
#br

そして、その後に「ファイル（F）」メニューの、「セッションの保存（W）...」を選んでください。

#br
#br

CENTER:''今開いているファイルをセッションとして保存してみる''
CENTER:#ref(02.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){とりあえずデスクトップを選んでみました。};

#br
#br

デスクトップに''〜〜〜.ssn''というファイルができていると思います。


#br
#br

CENTER:''セッションファイルの状態''
CENTER:#ref(03.png,center,100%)
CENTER:#img(,clear)
CENTER:&size(10){デスクトップにセッションファイルができた。};

#br
#br

終わったら、xyzzyを再起動します。その後、上で保存したセッションファイルを開くと、三つのファイルが開かれた状態になります。
ここで注意。単純にダブルクリックするなどしてxyzzyにファイルを読み込ませると、下のようになってしまいます。

#br
#br

CENTER:''上手く開けなかった例''
CENTER:#ref(04.png,center,100%)
CENTER:#img(,clear)
CENTER:&size(10){セッションを普通のテキストファイルとして開いているので、うまく開けてません。};

#br
#br

セッションファイルを（セッションファイルとして）開くには、「ファイル（F）」メニューの「セッションを開く（D）...」を選択するか、あるいはミニバッファに「load-session」と入力して保存したセッションファイルのパスを入力すればOKです。だけど、その二つの方法は面倒くさいので、この後、ダブルクリックをすれば開くように設定を変更する手順を説明します。

#br
#br

CENTER:''「セッションを開く...」から開けば大丈夫''
CENTER:#ref(05.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){保存したセッションファイルを選ぶ};

#br
#br

上の方法で開くと、さっきとは違って三つのファイルが開けていると思います。

#br
#br

CENTER:''ちゃんと開けている例''
CENTER:#ref(06.png,center,100%)
CENTER:#img(,clear)
CENTER:&size(10){ちょっと上の方法だと面倒くさいので、やっぱり拡張子で登録しましょうか :p };

#br
#br

上の画像を良く見てもらえばわかるとおり、どのファイルが前面にあったのかとか、行カーソルの位置も、すっかり保存する前と同じになっています。また、この例では説明してませんが、画面を二分割した状態で保存したら、そのままの状態で元に戻ります。モードも見てみてください。保存する前の状況と同じですね。

今までの例で大体わかったと思いますが、セッションファイルを使うと、セッションを保存した時の状態を再現してくれます。単に一つのファイルで複数のファイルを開ける所だけでも便利だと思います。((良く知らないけど、開発環境とかのプロジェクトファイルとかに近いものだと思う。))

**ダブルクリックで開けるようにしよう [#g503313f]

ダブルクリックして開けるようになると、さらに便利になると思うので、その手順を紹介します。

それにはフォルダオプションダイアログから拡張子を登録すれば良いだけです。
まずエクスプローラから、「ツール（T）...」メニューの「フォルダオプション（O）...」を選択します。ダイアログが出るので、「ファイルの種類」タブを選択します。前にやったことがあると思うので、画面は省略します。
画像が見たい方はファイルを開こうの関連付けをしよう!の見出しから始まる所に書いてありますので、そちらを見てください。（と言っても、上で説明した通りです）

表示させたら、「新規（N）」ボタンを押して、拡張子にssnと入力します。そしたら登録した拡張子を選択して、「詳細設定」ボタンを押します。（下図）

#br
#br

CENTER:''ssnファイルを登録して「詳細設定」ボタンを押した所''
CENTER:#ref(07.png,center,100%)
CENTER:#img(,clear)
CENTER:&size(10){こんな感じではないでしょうか?「xyzzyセッションファイル」の所は好きな文字を入れればOKです。そんでもってアイコンを変えたい人は適当に選んでください。};

#br
#br

おそらく「ダウンロード〜〜」というチェックボックスにチェックが入っていると思いますが、どちらでもいいと思います。自分は外しておきました。（セッションファイルをダウンロードする事は無いと思います）
その後、「新規（N）...」ボタンを押して、以下の図のように入力してください。

#br
#br

CENTER:''設定例''
CENTER:#ref(08.png,center,100%)
CENTER:#img(,clear)
CENTER:&size(10){セッションファイルを開けるように登録してみた例};

#br
#br

前にtxtファイルを変更した時にやった方はわかると思いますが、上にopenと入力して、下の部分には、

 "xyzzycli.exeのパス" -S "%1"

と入力します。前回と違って、''"%1"の前に-S が付きます。''入力し終わったら、OKボタンを押してダイアログを閉じていきます。実際にダブルクリックすると、セッションファイルをxyzzyで開くようになっていると思います。

**他にも幾つかのオプションがある [#i3239261]

上では、-S と入力しましたが、セッションファイルに関係した起動オプションは幾つかあって、上以外のでも良いです。例えば、大文字のSの代わりに小文字のsを指定すると、セッションファイルを開いた後に新しく開いたファイルも、次回セッションファイルを開いた時に一緒に開いてくれるようになります。

また、セッション関係の起動オプションだけでなく、xyzzyにはかなり多くの起動オプションが用意されています。詳しくは、xyzzyのフォルダ内のhtmlフォルダにある、00README.htmlを参照ください。((-mあたりも便利かも。だけど、たいていの場合xyzzy側でうまく開いてくれますが……。))

**セッションファイルは簡単で強力だね [#m91352d9]

ということで今回は終了です。次回は''フレーム（もどき）''について説明します。
