#freeze
#contents

*ファイルを開こう [#t701974a]

**前口上 [#vb30ec4c]

前回まででファイルの編集の仕方が(なんとなく)わかったと思います。とりあえず一番重要だと思うのは、''コピーがC-Insert''で、''ペーストがS-Insert''ってところくらいでしょうか。((ペーストは言ってなかったけどね))

まぁ、他にも（Wordやメモ帳等と比較すると）むちゃくちゃ違うところばっかりかとも思いますが、どうしてもいやだ！！ って人以外はそのままのキーで覚えていったほうが、後々他のモードを使用する時とか、UnixなどでEmacs（系）のエディタを触る機会があった時のこととかを考えると、自分で設定をしなおす手間が省けるので良いでしょう。((Windowsでは変に思えるけど、結構融通の利くキーバインドです。もちろんWindows風に直すのも自由です。))

さて今回はエクスプローラからのファイルの開き方の話です。要するに、''ダブルクリックした時とかにxyzzyで開くようにしよう''、ってことです。
そんなことはもう余裕という人もいるかもしれないけれど、一応説明しておこうと思います。

その前に、xyzzyのフォルダ内にある「xyzzy.exe」と「xyzzycli.exe」の話をします。この二つのアプリケーションは少し違う働きをします。関連付けをする時にはどちらにするのかで結構挙動が違います。((自分はxyzzycli.exe。ほとんどの人は、そうすると思うけどね……))

**ちょっとその前に…… [#k3429b4b]

もう一度xyzzyのフォルダを見てみてください。

#br
#br

CENTER:''xyzzyのフォルダの中''
CENTER:#ref(01.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){ちょっと前と注目するところが変わっています。};
#br
#br

前に見たときには、新しく出来たファイル(やフォルダ)を見てもらいましたけど、今回は三つの(カメの形をした)アイコンに注目してください。よく見ると、xyzzyのフォルダの中には三つのアプリケーションが入っています。(etcって名前のフォルダの中にはさらに.exeのアプリケーションがありますが、今回の話題と関係ないので、割愛します。)
それぞれ、

-xyzzy.exe
-xyzzycli.exe
-xyzzyenv.exe

という名前になっていると思います。私のような近眼の人以外にはさらに、xyzzy.exeのアイコンには、かめさんが鉛筆を持っていて他の二つと異なっていることがわかると思います。

実はこの三つのアプリは同じようなアイコンの割には役割が違います。それについて説明します。

**実際に起動させてみる [#u9179cdd]

どこか違うのか知るのには実際に起動させて見れば一目瞭然です。と言うことでやってみましょうか。

まずは鉛筆の付いたxyzzy.exeを起動させてみます。すると、今までと同じくxyzzyが起動します。(当たり前だけど)

#br
#br

CENTER:''xyzzy.exeを起動''
CENTER:#ref(02.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){当たり前だけどね。};
#br
#br

次に起動させたxyzzyを一度終了してから、今度は鉛筆の付いていないxyzzycli.exeを起動させてみます。すると、前の鉛筆が付いている時と同じく、xyzzyが起動します。

#br
#br

CENTER:''xyzzyを終了させてからxyzzycli.exeを起動''
CENTER:#ref(03.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){前と変わらない。};
#br
#br

最後に、同様にxyzzyを終了してからxyzzyenv.exeを起動させてみます。すると、今までとは違って瞬間的に黒い画面が出た後に(勝手に)終了します。前の二つとはぜんぜん違いますね。

#br
#br

CENTER:''なし''
#br
#br
CENTER:&size(10){絵はないです。撮ろうにも撮れなかった。 :p };

#br
#br

とりあえず今までからxyzzyenv.exeは前の二つとは違う感じを受けますね。では、鉛筆の付いた「xyzzy.exe」と「xyzzycli.exe」ってのはどこが違うのでしょうか？

これを知るにはxyzzyを起動させた状態にして置かないとダメなんです。一つxyzzyを起動させて((xyzzy.exeでもxyzzycli.exeでもどっちでもいいので起動させて))、それからさらに前回と同じ操作をしてみてください。

すると……

#br
#br

CENTER:''xyzzyを起動させた状態でもう一度xyzzy.exe((鉛筆の付いた方))を起動''
CENTER:#ref(04.png,center,100%)
CENTER:#img(,clear)
CENTER:&size(10){見てのとおりタスクバーには、''二つxyzzyが起動''しています。};

#br
#br

xyzzyを起動させた状態でもう一度xyzzycli.exe(鉛筆の付いていない方)を起動

#br
#br

CENTER:''xyzzyを起動させたままさらにxyzzy.exeを押す''
CENTER:#ref(05.png,center,100%)
CENTER:#img(,clear)
CENTER:&size(10){タスクバーには↑のxyzzy.exeを押した時とは異なり、一つだけ。その代わり、最小化していたxyzzyが前面に来ます。};

#br
#br

というようになります。つまり、xyzzy.exe((鉛筆を持った方))はxyzzyが起動しているか、いないかに関係なく、新規に起動させるアプリケーションですが、xyzzycli.exe((鉛筆持っていない方))は、既にあるxyzzyを前面に持ってくる((フォアグラウンドにする、等と言う模様))アプリケーションです。
つまりは、新しくファイルを開く時にxyzzy.exeで開こうとすると、毎回新たにxyzzyが起動するようになります。もう一方のxyzzycli.exeでファイルを開くと、既に起動しているxyzzyの中でファイルを開くようにしてくれます。

ちなみにWindowsに付属するメモ帳では、ファイルを開くたびに、新しいウィンドウで表示されますよね。

#br
#br

CENTER:''メモ帳で複数のファイルを編集する時って……''
CENTER:#ref(06.png,center,100%)
CENTER:#img(,clear)
CENTER:&size(10){メモ帳を起動させると、こんな感じに、タスクバーにズラズラッと表示されますね。};

#br
#br

逆にOffiece系のアプリケーションの場合には、いくら開いていたとしても、タスクバーには一つしか表示されなくて、メニューバーにあるウィンドウ(W)から選択したりしてます。

#br
#br

CENTER:''Office系アプリケーションの場合''
CENTER:#ref(07.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){ウィンドウから選択してファイルの切り替えをしたりするような気がする。};

#br
#br

※ちなみに、前者をSDI((Single Document Interface の略))、後者をMDI((Multi Document Interface の略))などと言ったりすることもあるようです。((ただし、xyzzyはMDIではないです。xyzzyMLの6124通目に書かれています。))

**図にまとめると、 [#afb41101]

また？ って感じですが、自分は図にまとめるのが大好きなので((ホントか？))、まとめてみました。

#br
#br

CENTER:''今までのまとめ(xyzzy.exeとxyzzycli.exeの違いについて)''
CENTER:#ref(08.png,center,100%)
CENTER:#img(,clear)

#br
#br

ちなみに、xyzzyが二つ起動している状態でxyzzycli.exeを起動させた場合にはどっちが前面に出るのでしょうか？

xyzzy を全て最小化していた場合には、前面に来るxyzzyは順番に変わっていきます。一つだけxyzzyが最小化されていない場合にはその(最小化されていない)xyzzyで開くようです。また、複数のxyzzyが最小化されていない場合には、(ファイルを開く前に)前面にあった方のxyzzyで開くようです。(なかなかわかりにくい説明かも。実は今はじめて知りました)

とりあえず覚えておいてほしいのは、上のように、xyzzy.exeは起動するごとに新しいxyzzyを作り、xyzzycli.exeは起動するごとに既に起動中のxyzzyで開くという所です。(ない場合には新たに起動する、と。)

**xyzzyenv.exeは？ [#s53b9b2a]

忘れそうになってました。xyzzyenv.exeは(実は)ファイルを開くという動作をするものではないんですね。DOSっぽいが面が出たのでそちらと関係あります。

※今回の本編とはあんまり関係ないので、興味のある方は逸見さんが書かれていますので、逸見さんのページをご覧ください。ここでは割愛します。

**長い前置きだったが [#tcb924e9]

やっと本題に入ります。

ほとんどの人の場合、xyzzyを複数立ち上げる必要は無いと思うので、(自分は後述するGrepの時には新たに立ち上げるのですが)関連付けを行う際にはxyzzycli.exeを指定すればよろしいのではないでしょうか？

基本的に編集するファイルの切り替えをするのにいちいちAlt-Tabを押す必要がなくなるので、そっちの方が楽でしょう。編集ファイルの切り替えのキーを自分の好きなように設定できます。おそらくそっちの方が便利だと思います。

自分の場合はxyzzycli.exeに関連付けしています。普段編集している時はこんな感じ(↓)です。

#br
#br

CENTER:''自分の普段のxyzzy''
CENTER:#ref(09.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){やったらめったらファイルを開いています(左のたくさん並んでいるのが開いているファイル名)};

#br
#br

**関連付けをしよう！ [#le3603c0]

それでは実際の手順を説明します。関連付けについては、特にxyzzy固有の設定はありません。xyzzyのパスとアプリケーション名を" "(ダブルクオーテーション)で囲み、%1も同様に囲めばOKです。具体的には以下のようにします。

 "C:\hoge\bar\xyzzy\xyzzycli.exe(とか、xyzzy.exe)" "%1"

パスと"%1"の間には半角のスペースを入れてください。この説明が良くわからない人は続きを読んでいってくださいませ。

***実際の手順 [#y62db3c0]

まずxyzzyをインストールしたフォルダを開き、パスをコピーしましょう。

#br
#br

CENTER:''xyzzyのパスをコピーする''
CENTER:#ref(10.png,center,50%)
CENTER:#img(,clear)

#br
#br

次に関連付けのウィンドウを表示します。エクスプローラでメニューバーの「ツール(T)→フォルダオプション(O)...をクリックします。

#br
#br

CENTER:''フォルダオプションを選択''
CENTER:#ref(11.png,center,100%)
CENTER:#img(,clear)
CENTER:&size(10){エクスプローラのメニューですよ。念のため。};

#br
#br

すると、ダイアログが出ると思います。そしたら、「ファイルの種類」タブを選んでください。

#br
#br

CENTER:''フォルダオプションのダイアログ''
CENTER:#ref(12.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){「ファイルの種類」タブを選択しています。};

#br
#br

そうしたら、ダブルクリックした時にxyzzyで開きたい拡張子を選択し、「詳細設定(V)」ボタンを押します。テキストファイル(.txt)あたりがポピュラーでしょう。きっと。
すると、以下のダイアログが出ると思います。

#br
#br

CENTER:''ファイルの種類の編集ダイアログ''
CENTER:#ref(13.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){こんな画面が出ると思う。};

#br
#br

openが選択されていることを確認して「編集(E)...」ボタンを押します。すると、以下のダイアログが出ると思いますので、「アクションを実行するアプリケーション(L):」って所の下の所にパスを入れます。
この時、パスを""(ダブルクオーテーション)で囲むのお忘れなく。例えば(上にも書きましたけど) パスが、

 C:\xyzzy

ならば、""で括り、"C:\xyzzy\関連付けたいアプリ(例:xyzzycli.exe)"とします。
パスを入力して括った後には、 半角スペースを一つ(くらい)入れて、 "%1"を入れてください。 %1の方も括らないと開くファイルのパスに空白が含まれる場合にそこでちょん切れてしまいます。(例:C://Documentsとかでファイルが開かれて、開きたいファイルが開けなくなります)

全部入れると下みたいになります。各自ご確認を。


#br
#br

CENTER:''関連付け終了！''
CENTER:#ref(14.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){これで終了。DDEとかはどちらでもいいと思います。（ダメだったら教えてください。よくわからないので……。）};

#br
#br

終わったらダイアログを閉じていきましょう。「OK」や「閉じる」を選択していってください。

#br
#br

CENTER:''参考''

Windows 2000のxyzzy 0.2.2.234で上述の関連付けを試したところ、「DDEを使う（U）」にチェックを入れると、Winowsとうまく通信できないようでExplorerがケチをつけてきます。
とりあえず、「DDEを使う（U）」にチェックはいれないで、「アクションを実行するアプリケーション（L）」には xyzzycli.exe が指定してあれば「おけ」のようですぅ。
通りすがりのタレコミ人より。

#br
#br

**起動させる [#b338c2ce]

これで拡張子がtxtのものをダブルクリックした時にxyzzyで開かれるようになっていると思います。その画面は必要ないような気がするので省略します。
ダメだった場合には、ほとんどの場合パスに問題があるように思いますので、確認してみてください。また、txtを修正しても他の拡張子は変わっていないので、自分の変更した拡張子はしっかり覚えておくのが良いかと。(知っているとは思いますけど、念のため)

***番外編:1いちいち面倒なこと出来るか！！ [#td959d88]

いちいち拡張子など気にしてやるなんて面倒だ〜〜、というそんな短気な(自分みたいな)人の場合には、エクスプローラの「送る」というメニューを使った方が良いかもしれません。
ここに登録しておけば、マウスで右クリックして、送るから「xyzzycli.exe(とかxyzzy.exe)」を選択すれば開いてくれます。
(といっても、もっと楽なのは、xyzzyを起動させた状態で、開きたいファイルをxyzzyの画面にドロップすればいいのですけれども)

一応需要があるかもしれないので、書いておきます。

WindowsXPの場合、"起動ドライブ\Documents and Settings\ユーザ名\"というフォルダを開いてもらうと、そこに「SendTo」なるフォルダがあると思います。
その中にxyzzyのショートカットをおいておくだけです。

#br
#br

CENTER:''「送る(N)から開けるように''
CENTER:#ref(15.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){ここに置いておけば、エクスプローラの右クリックメニューの中の「送る(N)」から呼び出せます。xyzzyだけでなく、他のアプリでもオッケーです。自分の場合、「Xyzzy」というのがxyzzycli.exeのショートカットです。};

#br
#br

上の場所に置けば、下みたいに呼び出して起動できます。比較的便利です。

#br
#br

CENTER:''実際の例''
CENTER:#ref(16.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){関連付けに関係なく開けます。もちろん拡張子がないファイルなどもOK。};

#br
#br

この作業でもさらにイライラするという方には窓の手を勧めておきます。関連付けされていないファイルを特定アプリケーションで開く設定が行えるので、そこに指定しておくのもなかなか便利です。

***IEのソースをxyzzyで見たいよー [#ec333e61]

幾つか方法があるのですが、自分の場合には、レジストリを変更しています。クールなツールさんのページに載っていました。
※この方法はIE6のみでしかできないらしいです。ご注意ください。

具体的には、

 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\View Source Editor\Editor Name

に、xyzzyのパスを記述します。

自分は以下のようにしました。なお、レジストリいじりは(結構)危険な作業なので、実際に作業を行うときには気をつけてください。

#br
#br

CENTER:#ref(17.png,center,50%)
CENTER:#img(,clear)
CENTER:&size(10){パスについてはステータスバーを見て考えてくださいませ。これを設定すると他のユーザーもxyzzyで開いてしまうような気もするんだけど……。};

#br
#br

また、xyzzyをメモ帳のふりをさせる方法も存在します。これを設定すると、メモ帳で開かれるよう関連付けされたファイル(やIEのソース等)を全てxyzzycli.exeで開くように出来ます。 それについてはすぎやまさんが書かれていますので、[[xyzzyのIEでページのソースをxyzzyで開く:http://chez-sugi.net/xyzzy/000951.html]]のセクションを参照してみてください。

**着々と [#be72fdb5]

xyzzyを利用する環境が整いつつありますね。もうそろそろ、普段使用するときにも不便ではなくなるのではないでしょうか？(キーバインド以外は、っていう条件付きだとは思うけど)

次回はxyzzyと他のwindows系エディタの違いの一つとなるミニバッファについてです。
