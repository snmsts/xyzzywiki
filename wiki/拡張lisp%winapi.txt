*winapiについて [#zd5346e9]
windowsのapiを使えるようlispでの宣言を集めたものです。~
windows開発の経験が多少あると、（特にVB等スクリプト系が強そう）すごく良くわかると思います。

*winapiの使い方 [#tda491d0]
よくわかりません。……。~
というのは良く無い気がしますが、出来ることの全体像は僕には見えていません。~
ただVBのAPI系のページをみていると解るようになるかもしれません。~
http://homepage1.nifty.com/MADIA/vb/VBKANREN.htmなど~
wip/hellowin.lやユーザの書いたサンプルなどを参照するのもいいかもしれません。~
僕自身はそれだけを勉強した記憶が無いので良いアドバイスが出来ませんが…
**もう少し詳しく [#a918f3fe]
***注意 [#h71ed929]
僕ん所だと当然のように(use-package "winapi")してあるのでそれが嫌な人は適宜いろいろやってください。
***SendMessageを使いこなす。 [#o737ad71]
具体例としてなにがいいのかを考えたところSendMessageを極めるのが楽しいかもしれないと思いました。~
SendMessageでなにができるかというと、マウスでの入力やキーボードの入力やらを自動化することが出来るといった所です。~
ここいらの操作はXyzzyのインタープリタ的な環境との親和性が驚くほど高いです。~
作業の手順を以下に示します。
+ウィンドウハンドルを取得する（操作すべきウィンドウを指定する)~
ウィンドウハンドルの取得は[[FindWindow:http://www.microsoft.com/JAPAN/developer/library/jpuipf/_win32_findwindow.htm]]を使います。（他の方法もあります~
reference.chmの場合
 (FindWindow (si::make-string-chunk"HH Parent") (si::make-string-chunk "xyzzy Reference"))
とかそんな感じ~
si::make-string-chunkはリファレンスを参照してください基本的にはapiとxyzzy内部での文字列の扱いが違うのでその変換をする関数です。~
第二引数は起動したときにみられるウィンドウのタイトルです。~
第一引数の値はどうやって取得するか…という事がわからないときは0でも大丈夫です。~
そこらへんの取得をサポートする。プログラム((動く環境であれば窓使いの憂鬱がお勧めです))はそのうちかこうかと思います。~
戻り値はヘルプを見ると大層なことが書いてあるけれども整数値です。~
これを使ってメッセージ処理が出来ます。
+メッセージをウィンドウに送る~
上記の処理をhwnd-xyzzy-htmlhelpとかしてみて、
 (SendMessage (hwnd-xyzzy-htmlhelp) WM_CLOSE 0 0))
こんな感じで…最小化になります。WM_CLOSEというのが動作の種類((どっかに良い説明ないでしょうか？))です。~
中途半端ですが今日のところはこんな感じで。
*api.lの作り方 [#c0830c7c]
ベースとしているのは
:borland C++ Compiler|http://www.borland.co.jp/cppbuilder/freecompiler/

です。includeディレクトリ内を手で :( 変換しています。~
お手伝いさん募集中です :)
----
-turtle.l で遊ぶために wingdi.h から変換したものを置いておきます。お暇な時にマージしていただけると幸いです。 -- [[NANRI]] &new{2004-06-17 (木) 19:48:11};
-了解しました。少々立てこんでいるので時間がかかりそうですがtodo listに入りました。 -- [[佐野]] &new{2004-06-17 (木) 23:03:55};
- 作り方って何? layered-window の readme から飛んできたんだけど,api.l のインストールの説明なんかどこにもない (*3*) --  &new{2009-09-20 (日) 21:02:01};
- 下部に添付ファイル (api050525.lzh) があるので、これのことかと。位置的に確かに分かりにくい。 --  &new{2011-03-03 (木) 18:18:44};
-- ちなみに今はNetInstallerで提供されています。http://xyzzy.s53.xrea.com/ni/api2006.06.15.tgz --  &new{2011-03-03 (木) 21:13:34};

#comment
